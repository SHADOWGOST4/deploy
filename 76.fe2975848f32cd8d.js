"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[76],{76:(I,g,l)=>{l.r(g),l.d(g,{HabitListPageModule:()=>T});var u=l(8434),H=l(4341),r=l(2910),m=l(33),h=l(467),t=l(1360),v=l(3656),p=l(6210),C=l(2276);let b=(()=>{var o;class n{constructor(i,e){this.router=i,this.habitosService=e,this.toggle=new t.bkB}onToggle(){this.toggle.emit(this.habito)}verDetalle(){this.router.navigate(["/habit-detail",this.habito.id])}eliminar(){this.habitosService.eliminarHabito(this.habito.id)}}return(o=n).\u0275fac=function(i){return new(i||o)(t.rXU(C.Ix),t.rXU(p.s))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-habit-item"]],inputs:{habito:"habito"},outputs:{toggle:"toggle"},decls:13,vars:6,consts:[[3,"click"],["mode","md","slot","end",3,"checked"],["side","end"],["color","primary",3,"click"],["color","danger",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"ion-item-sliding")(1,"ion-item",0),t.bIt("click",function(){return e.onToggle()}),t.nrm(2,"ion-checkbox",1),t.j41(3,"ion-label")(4,"h2"),t.EFF(5),t.k0s(),t.j41(6,"p"),t.EFF(7),t.k0s()()(),t.j41(8,"ion-item-options",2)(9,"ion-item-option",3),t.bIt("click",function(){return e.verDetalle()}),t.EFF(10,"Ver"),t.k0s(),t.j41(11,"ion-item-option",4),t.bIt("click",function(){return e.eliminar()}),t.EFF(12,"Eliminar"),t.k0s()()()),2&i&&(t.R7$(),t.AVh("habito-completado",e.habito.completado),t.R7$(),t.Y8G("checked",e.habito.completado),t.R7$(3),t.JRh(e.habito.nombre),t.R7$(2),t.Lme("",e.habito.descripcion," \u2014 Frecuencia: ",e.habito.frecuencia,""))},dependencies:[r.bv,r.eY,r.uz,r.LU,r.CE,r.A7,r.he,r.hB],styles:["ion-item[_ngcontent-%COMP%]{--background: #1f1f1f;--color: #ffffff;margin-bottom:8px;border-radius:10px;padding:10px 12px;font-size:16px}ion-item.habito-completado[_ngcontent-%COMP%]{opacity:.5;text-decoration:line-through;--background: #1e1e1e}ion-checkbox[_ngcontent-%COMP%]{--background: #1f1f1f;--color: #ffffff;--border-radius: 12px;margin-right:10px}"]}),n})();function _(o,n){if(1&o){const s=t.RV6();t.j41(0,"app-habit-item",2),t.bIt("toggle",function(){const e=t.eBV(s).$implicit,a=t.XpG();return t.Njj(a.onToggle(e))}),t.k0s()}2&o&&t.Y8G("habito",n.$implicit)}let d=(()=>{var o;class n{constructor(){this.titulo="",this.habitos=[],this.toggle=new t.bkB}onToggle(i){this.toggle.emit(i)}}return(o=n).\u0275fac=function(i){return new(i||o)},o.\u0275cmp=t.VBU({type:o,selectors:[["app-habit-list-group"]],inputs:{titulo:"titulo",habitos:"habitos"},outputs:{toggle:"toggle"},decls:4,vars:2,consts:[["mode","md"],[3,"habito","toggle",4,"ngFor","ngForOf"],[3,"toggle","habito"]],template:function(i,e){1&i&&(t.j41(0,"h2"),t.EFF(1),t.k0s(),t.j41(2,"ion-list",0),t.DNE(3,_,1,1,"app-habit-item",1),t.k0s()),2&i&&(t.R7$(),t.JRh(e.titulo),t.R7$(2),t.Y8G("ngForOf",e.habitos))},dependencies:[u.MD,u.Sq,r.bv,r.nf,b],styles:["ion-list[_ngcontent-%COMP%]{background:#1e1e1e}h2[_ngcontent-%COMP%]{color:#fff}"]}),n})();function F(o,n){1&o&&(t.j41(0,"ion-text")(1,"p"),t.EFF(2,"No has registrado h\xe1bitos a\xfan."),t.k0s()())}const k=[{path:"",component:(()=>{var o;class n{ngOnInit(){this.cargarHabitos(),this.iniciarAutoReactivacion()}ngOnDestroy(){this.intervaloAutoReactivo&&clearInterval(this.intervaloAutoReactivo)}iniciarAutoReactivacion(){this.intervaloAutoReactivo=setInterval(()=>{let i=0;this.habitos.forEach(e=>{this.isDueToday(e)&&e.completado&&(e.completado=!1,i++)}),i>0&&(this.guardarHabitos(),this.mostrarAutoReactivoToast(i))},1e4)}mostrarAutoReactivoToast(i){var e=this;return(0,h.A)(function*(){(yield e.toastController.create({message:`${i} h\xe1bito(s) han sido reactivados autom\xe1ticamente.`,duration:3e3,color:"primary"})).present()})()}constructor(i,e,a){this.navCtrl=i,this.toastController=e,this.habitosService=a,this.habito={id:"",nombre:"",descripcion:"",frecuencia:"",completado:!1,historial:[]},this.habitos=[],this.cargarHabitos()}ionViewWillEnter(){var i=this;return(0,h.A)(function*(){i.cargarHabitos()})()}isDueToday(i){if(!i.historial||0===i.historial.length)return!0;const e=this.obtenerUltimaFecha(i),a=new Date;if(!e)return!0;switch(i.frecuencia){case"diario":return e.toDateString()!==a.toDateString();case"semanal":return this.diasDeDiferencia(e,a)>=7;case"mensual":return e.getMonth()!==a.getMonth()||e.getFullYear()!==a.getFullYear();case"cada-minuto":return this.minutosDeDiferencia(e,a)>=1;default:return!1}}irACrearHabito(){this.navCtrl.navigateForward("/habit-add")}cargarHabitos(){this.habitos=this.habitosService.obtenerHabitos()}guardarHabitos(){this.habitosService.guardarHabitos(this.habitos)}toggleCompletado(i){if(i.completado=!i.completado,i.completado){i.historial||(i.historial=[]);const e=new Date,a=this.obtenerUltimaFecha(i);let c=!1;if(a)switch(i.frecuencia){case"diario":c=a.toDateString()!==e.toDateString();break;case"semanal":c=this.diasDeDiferencia(a,e)>=7;break;case"mensual":c=a.getMonth()!==e.getMonth()||a.getFullYear()!==e.getFullYear();break;case"cada-minuto":c=this.minutosDeDiferencia(a,e)>=1;break;default:c=!1}else c=!0;c&&(i.historial.push(e.toISOString()),this.mostrarFelicitacion())}this.habitosService.guardarHabitos(this.habitos),this.habitos=[...this.habitos.filter(e=>!e.completado),...this.habitos.filter(e=>e.completado)]}getHabitosPendientes(){return this.habitos.filter(i=>!i.completado)}getHabitosCompletados(){return this.habitos.filter(i=>i.completado)}irAHistorial(){this.navCtrl.navigateForward("/habit-history")}mostrarFelicitacion(){var i=this;return(0,h.A)(function*(){i.reproducirSonido(),yield(yield i.toastController.create({message:"\xa1Has completado tu h\xe1bito de hoy! \xa1Sigue as\xed!",duration:3e3,color:"success"})).present()})()}reproducirSonido(){new Audio("assets/sounds/success.mp3").play()}obtenerUltimaFecha(i){return i.historial&&0!==i.historial.length?new Date(i.historial[i.historial.length-1]):null}diasDeDiferencia(i,e){const a=new Date(i.toISOString().split("T")[0]),c=new Date(e.toISOString().split("T")[0]);return Math.floor((c.getTime()-a.getTime())/864e5)}minutosDeDiferencia(i,e){return Math.floor((e.getTime()-i.getTime())/6e4)}}return(o=n).\u0275fac=function(i){return new(i||o)(t.rXU(v.q9),t.rXU(r.K_),t.rXU(p.s))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-habit-list"]],standalone:!1,decls:9,vars:5,consts:[[1,"ion-padding"],[3,"toggle","titulo","habitos"],[4,"ngIf"],["expand","full",3,"click"],["expand","full","color","secondary",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"ion-content",0)(1,"app-habit-list-group",1),t.bIt("toggle",function(c){return e.toggleCompletado(c)}),t.k0s(),t.nrm(2,"hr"),t.j41(3,"app-habit-list-group",1),t.bIt("toggle",function(c){return e.toggleCompletado(c)}),t.k0s(),t.DNE(4,F,3,0,"ion-text",2),t.j41(5,"ion-button",3),t.bIt("click",function(){return e.irACrearHabito()}),t.EFF(6,"A\xf1adir H\xe1bito"),t.k0s(),t.j41(7,"ion-button",4),t.bIt("click",function(){return e.irAHistorial()}),t.EFF(8," Ver Historial de Progreso "),t.k0s()()),2&i&&(t.R7$(),t.Y8G("titulo","H\xe1bitos Pendientes")("habitos",e.getHabitosPendientes()),t.R7$(2),t.Y8G("titulo","H\xe1bitos Completados")("habitos",e.getHabitosCompletados()),t.R7$(),t.Y8G("ngIf",0===e.habitos.length))},dependencies:[u.bT,r.Jm,r.W9,r.IO,d],styles:["ion-content[_ngcontent-%COMP%]{--background: #121212;color:#fff}ion-toolbar[_ngcontent-%COMP%]{--background: #1f1f1f;--color: #ffffff}hr[_ngcontent-%COMP%]{border-color:#444;margin:24px 0}"]}),n})()}];let P=(()=>{var o;class n{}return(o=n).\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[m.iI.forChild(k),m.iI]}),n})();var f=l(1893),D=l(8982),L=l.n(D);let T=(()=>{var o;class n{}return(o=n).\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({providers:[(0,f.B)({player:()=>L()})],imports:[u.MD,H.YN,r.bv,P,f.xm,b,d]}),n})()}}]);